import"../chunks/Bg9kRutz.js";import{e as _e,f as ke,t as h,g as me,s as c,i as r,j as e,D as k,r as i,ae as L,af as be}from"../chunks/Da0nnPzC.js";import{d as je,s as _}from"../chunks/Dad94sqd.js";import{i as D}from"../chunks/pJBJIWGn.js";import{e as R,i as Y,s as he}from"../chunks/_G73yJXa.js";import{a as d,t as f}from"../chunks/-Ct6wzUb.js";import{s as ge}from"../chunks/CamT9boV.js";import{p as $}from"../chunks/C-xoV1eZ.js";import{o as Ge}from"../chunks/T8PLpSSH.js";function ye(M,T,s){k(T,void 0),k(s,0)}var Ce=f('<div class="stat svelte-7ijfkc"><span class="stat-label svelte-7ijfkc">Last Score:</span> <span class="stat-value svelte-7ijfkc"> </span></div>'),Pe=f('<div class="stat streak svelte-7ijfkc"><span class="stat-label svelte-7ijfkc">Current Streak:</span> <span class="stat-value svelte-7ijfkc"> </span></div>'),Te=f('<button class="level-btn svelte-7ijfkc"><h3 class="svelte-7ijfkc"> </h3> <p class="svelte-7ijfkc"> </p></button>'),xe=f('<div class="level-selection svelte-7ijfkc"><h2 class="svelte-7ijfkc">Select a Level</h2> <div class="levels-grid svelte-7ijfkc"></div></div>'),we=(M,T,s,m)=>T(e(s),e(m)),Ae=f("<button> </button>"),Ne=f('<div class="octave-row svelte-7ijfkc"><div class="octave-label svelte-7ijfkc"> </div> <div class="keyboard svelte-7ijfkc"></div></div>'),De=f('<div class="feedback-correct svelte-7ijfkc">Correct!</div>'),Se=f('<div class="feedback-incorrect svelte-7ijfkc"> </div>'),Ee=f('<div class="feedback svelte-7ijfkc"><!></div>'),Le=f('<div class="feedback feedback-placeholder svelte-7ijfkc"><div class="feedback-correct svelte-7ijfkc">Correct!</div></div>'),$e=f(`<div class="practice-area svelte-7ijfkc"><div class="level-cleared svelte-7ijfkc"><span class="svelte-7ijfkc">ðŸŽ‰ Congratulations! You've cleared this level for today! ðŸŽ‰</span></div> <div class="controls svelte-7ijfkc"><button class="play-btn svelte-7ijfkc"> </button> <button class="exit-btn svelte-7ijfkc">Exit Practice</button></div> <div class="keyboard-container svelte-7ijfkc"></div> <div class="feedback-container svelte-7ijfkc"><!></div></div>`),Me=f('<header class="svelte-7ijfkc"><h1 class="svelte-7ijfkc">Perfect Pitch Trainer</h1> <div class="stats svelte-7ijfkc"><div class="stat svelte-7ijfkc"><span class="stat-label svelte-7ijfkc">Lifetime Points:</span> <span class="stat-value svelte-7ijfkc"> </span></div> <!> <!></div></header> <div class="content svelte-7ijfkc"><!></div>',1);function He(M,T){_e(T,!0);let s=L(void 0),m=L(0),x=L(0),v=L(void 0);const C={},q=[{points:1,name:"Level 1: Basic C Notes",description:"Distinguish between middle C (C4), C5 (octave above), and C3 (octave below)",notes:["C"],octaves:[3,4,5]},{points:2,name:"Level 2: Extended C Range",description:"Adds C3.5 and C4.5 (E notes, which are halfway between these octaves)",notes:["C","E"],octaves:[3,4,5]},{points:3,name:"Level 3: More Intermediate Notes",description:"Adds more notes between octaves (C, D, E, F, G, A, B)",notes:["C","D","E","F","G","A","B"],octaves:[3,4,5]},{points:4,name:"Level 4: All Natural Notes",description:"All natural notes across 3 octaves",notes:["C","D","E","F","G","A","B"],octaves:[2,3,4,5,6]},{points:5,name:"Level 5: All Notes (Sharps and Flats)",description:"All notes including sharps and flats across 3 octaves",notes:["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],octaves:[2,3,4,5,6]}];function W(a){const t=q[a];t&&(k(s,$({points:t.points,notes:t.notes,octaves:t.octaves,noteToGuess:"",isPlaying:!1,userGuess:void 0,levelCleared:!1})),k(m,0),z())}function z(){if(!e(s))return;const a=Math.floor(Math.random()*e(s).notes.length),t=Math.floor(Math.random()*e(s).octaves.length),o=e(s).notes[a],n=e(s).octaves[t],l=`${o}${n}`;e(s).noteToGuess=l,e(s).isPlaying=!1,e(s).userGuess=void 0,X(l),setTimeout(()=>{B()},300)}function B(){!e(s)||!e(s).noteToGuess||(Z(e(s).noteToGuess),e(s).isPlaying=!0,setTimeout(()=>{e(s)&&(e(s).isPlaying=!1)},1e3))}function X(a){if(C[a])return;const t=new Audio(`/piano-mp3/piano-mp3/${a}.mp3`);t.load(),C[a]=t}function Z(a){if(C[a])C[a].currentTime=0,C[a].play();else{const t=new Audio(`/piano-mp3/piano-mp3/${a}.mp3`);t.play(),C[a]=t}}function ee(a,t){if(!e(s)||e(s).userGuess!==void 0)return;const o=`${a}${t}`;e(s).userGuess=o,o===e(s).noteToGuess?(be(m),e(m)===20&&se(e(s)),setTimeout(()=>{z()},1e3)):(k(m,0),setTimeout(()=>{e(s)&&(e(s).userGuess=void 0,B())},1500))}function se(a){a.levelCleared=!0;const t=new Date().toISOString().split("T")[0],o=new Date(Date.now()-864e5).toISOString().split("T")[0];let n=a.points,l=n,b=1;if(e(v))if(e(v).date===t)if(b=e(v).doublePoints?2:1,n>e(v).points)l=(n-e(v).points)*b;else return;else e(v).date===o&&(l=n*2,b=2);k(x,e(x)+l),k(v,$({date:t,points:n,doublePoints:b===2})),te()}function te(){const a={lifetime_points:e(x),last_score:e(v)};localStorage.setItem("perfectPitchProgress",JSON.stringify(a))}function ae(){const a=localStorage.getItem("perfectPitchProgress");if(a)try{const t=JSON.parse(a);k(x,$(t.lifetime_points||0)),t.last_score&&k(v,$(t.last_score))}catch(t){console.error("Error loading saved progress:",t)}}function ie(a,t){if(!e(s)||e(s).userGuess===void 0)return"";const o=`${a}${t}`,n=o===e(s).noteToGuess;return o===e(s).userGuess?n?"correct":"incorrect":e(s).noteToGuess===o&&e(s).userGuess?"correct-answer":""}Ge(()=>{ae()});var H=Me(),F=ke(H),K=c(r(F),2),O=r(K),Q=c(r(O),2),oe=r(Q,!0);i(Q),i(O);var U=c(O,2);{var re=a=>{var t=Ce(),o=c(r(t),2),n=r(o);i(o),i(t),h(()=>_(n,`${e(v).points??""} pts on ${e(v).date??""}
					${(e(v).doublePoints?"(Double points today!)":"")??""}`)),d(a,t)};D(U,a=>{e(v)&&a(re)})}var ne=c(U,2);{var le=a=>{var t=Pe(),o=c(r(t),2),n=r(o,!0);i(o),i(t),h(()=>_(n,e(m))),d(a,t)};D(ne,a=>{e(s)&&a(le)})}i(K),i(F);var V=c(F,2),ce=r(V);{var ve=a=>{var t=xe(),o=c(r(t),2);R(o,21,()=>q,Y,(n,l,b)=>{var g=Te();g.__click=()=>W(b);var G=r(g),S=r(G,!0);i(G);var E=c(G,2),I=r(E,!0);i(E),i(g),h(()=>{_(S,e(l).name),_(I,e(l).description)}),d(n,g)}),i(o),i(t),d(a,t)},de=a=>{var t=$e(),o=r(t),n=c(o,2),l=r(n);l.__click=B;var b=r(l,!0);i(l);var g=c(l,2);g.__click=[ye,s,m],i(n);var G=c(n,2);R(G,21,()=>e(s).octaves,Y,(j,u)=>{var w=Ne(),A=r(w),J=r(A);i(A);var p=c(A,2);R(p,21,()=>e(s).notes,Y,(y,N)=>{var P=Ae();P.__click=[we,ee,N,u];var ue=r(P);i(P),h(pe=>{ge(P,`note-btn ${pe??""} svelte-7ijfkc`),P.disabled=e(s).userGuess!==void 0,_(ue,`${e(N)??""}${e(u)??""}`)},[()=>ie(e(N),e(u))]),d(y,P)}),i(p),i(w),h(()=>_(J,`Octave ${e(u)??""}`)),d(j,w)}),i(G);var S=c(G,2),E=r(S);{var I=j=>{var u=Ee(),w=r(u);{var A=p=>{var y=De();d(p,y)},J=p=>{var y=Se(),N=r(y);i(y),h(()=>_(N,`Incorrect. The correct note was ${e(s).noteToGuess??""}.`)),d(p,y)};D(w,p=>{e(s).userGuess===e(s).noteToGuess?p(A):p(J,!1)})}i(u),d(j,u)},fe=j=>{var u=Le();d(j,u)};D(E,j=>{e(s).userGuess!==void 0?j(I):j(fe,!1)})}i(S),i(t),h(()=>{he(o,"style",e(s).levelCleared?"":"visibility: hidden;"),l.disabled=e(s).isPlaying,_(b,e(s).isPlaying?"Playing...":"Play Note")}),d(a,t)};D(ce,a=>{e(s)===void 0?a(ve):a(de,!1)})}i(V),h(()=>_(oe,e(x))),d(M,H),me()}je(["click"]);export{He as component};
